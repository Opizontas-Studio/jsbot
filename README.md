# Gatekeeper Bot

åŸºäº Discord.js çš„ç°ä»£åŒ– Discord Bot é¡¹ç›®ï¼Œé‡‡ç”¨é…ç½®é©±åŠ¨çš„æ¨¡å—åŒ–æ¶æ„ã€‚

## ğŸ“‹ ç¯å¢ƒè¦æ±‚

- Node.js 18.x æˆ–æ›´é«˜ç‰ˆæœ¬
- pnpm åŒ…ç®¡ç†å™¨

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
# å®‰è£… pnpmï¼ˆå¦‚æœå°šæœªå®‰è£…ï¼‰
npm install -g pnpm

# å®‰è£…é¡¹ç›®ä¾èµ–
pnpm install
```

### 2. é…ç½®

1. åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
DISCORD_TOKEN=your_bot_token_here
NODE_ENV=development
```

2. é…ç½®æ–‡ä»¶ï¼š
    - å…¨å±€é…ç½®ï¼š`src/config/config.json`ï¼ˆå‚è€ƒ `src/config/SETUP.md`ï¼‰
    - æœåŠ¡å™¨é…ç½®ï¼š`src/config/guilds/{guildId}.json`

è¯¦ç»†é…ç½®è¯´æ˜è¯·æŸ¥çœ‹ `src/config/SETUP.md`ã€‚

### 3. è¿è¡Œ

```bash
# å¼€å‘ç¯å¢ƒ
pnpm start

# æµ‹è¯•æ¨¡å¼
pnpm run start:test
```

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
jsbot/
â”œâ”€â”€ src/                    # æºä»£ç ï¼ˆæ–°æ¶æ„ï¼‰
â”‚   â”œâ”€â”€ core/              # æ ¸å¿ƒæ¡†æ¶ï¼ˆApplicationã€Registryã€Container ç­‰ï¼‰
â”‚   â”œâ”€â”€ infrastructure/    # åŸºç¡€è®¾æ–½ï¼ˆæ•°æ®åº“ã€APIã€é˜Ÿåˆ—ã€ç›‘æ§ç­‰ï¼‰
â”‚   â”œâ”€â”€ modules/           # ä¸šåŠ¡æ¨¡å—
â”‚   â”œâ”€â”€ shared/            # å…±äº«å±‚ï¼ˆå·¥å‚ã€å·¥å…·ã€æœåŠ¡ï¼‰
â”‚   â”œâ”€â”€ config/            # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ tests/             # æµ‹è¯•
â”‚   â””â”€â”€ index.js           # å…¥å£æ–‡ä»¶
â”œâ”€â”€ archive/               # å½’æ¡£çš„æ—§ä»£ç 
â”œâ”€â”€ data/                  # æ•°æ®å­˜å‚¨
â”œâ”€â”€ logs/                  # æ—¥å¿—æ–‡ä»¶
â””â”€â”€ package.json
```

## ğŸ“š æ¶æ„ç‰¹æ€§

### é…ç½®å¼æ³¨å†Œ

æ¯ä¸ªå‘½ä»¤ã€ç»„ä»¶ã€äº‹ä»¶éƒ½æ˜¯æ ‡å‡†é…ç½®å¯¹è±¡ï¼Œæ ¸å¿ƒè‡ªåŠ¨æ‰«ææ³¨å†Œã€‚

### ä¾èµ–æ³¨å…¥

åŸºäº Container çš„æœåŠ¡ç®¡ç†ï¼Œæ”¯æŒä¾èµ–æ³¨å…¥å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚

### ä¸­é—´ä»¶æœºåˆ¶

deferã€æƒé™ã€å†·å´ã€ä½¿ç”¨åœºæ™¯éªŒè¯ç­‰ç»Ÿä¸€ç”±ä¸­é—´ä»¶å¤„ç†ã€‚

### API åŒ…è£…å±‚

æ‰€æœ‰ Discord API è°ƒç”¨ç»è¿‡ç»Ÿä¸€åŒ…è£…ï¼Œå®ç°ä¸»åŠ¨é™é€Ÿå’Œç›‘æ§ã€‚

### æ¨¡å—åŒ–è®¾è®¡

ä¸šåŠ¡æ¨¡å—å®Œå…¨ç‹¬ç«‹ï¼Œé€šè¿‡ç»Ÿä¸€æ¥å£ä¸æ ¸å¿ƒäº¤äº’ã€‚

è¯¦ç»†æ¶æ„æ–‡æ¡£è¯·æŸ¥çœ‹ `src/plan.md`ã€‚

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pnpm test

# ç›‘å¬æ¨¡å¼
pnpm run test:watch

# æµ‹è¯•è¦†ç›–ç‡
pnpm run test:coverage

# UI ç•Œé¢
pnpm run test:ui
```

## ğŸ“– å¼€å‘æŒ‡å—

### åˆ›å»ºæ–°å‘½ä»¤

1. åœ¨ `src/modules/{module}/registries/` ç›®å½•åˆ›å»ºé…ç½®æ–‡ä»¶
2. å¯¼å‡ºé…ç½®å¯¹è±¡æ•°ç»„
3. æ ¸å¿ƒä¼šè‡ªåŠ¨æ‰«æå¹¶æ³¨å†Œ

ç¤ºä¾‹ï¼š

```javascript
// src/modules/basic/registries/myCommands.js
export default [
    {
        id: 'basic.hello',
        type: 'command',
        commandKind: 'slash',
        name: 'hello',
        description: 'æ‰“ä¸ªæ‹›å‘¼',
        defer: true,
        async execute(ctx) {
            await ctx.success('ä½ å¥½ï¼');
        }
    }
];
```

### åˆ›å»ºä¸šåŠ¡æœåŠ¡

1. åœ¨ `src/modules/{module}/services/` ç›®å½•åˆ›å»ºæœåŠ¡ç±»
2. åœ¨ `src/core/bootstrap/services.js` æ³¨å†Œåˆ°å®¹å™¨
3. åœ¨é…ç½®å¯¹è±¡ä¸­é€šè¿‡ `inject` å£°æ˜ä¾èµ–

è¯¦ç»†å¼€å‘æ–‡æ¡£è¯·æŸ¥çœ‹ `src/docs/` ç›®å½•ã€‚

## ğŸ“ æ›´æ–°æ—¥å¿—

### v3.2.0 - 2025-11-17

- âœ… å®Œæˆæ¶æ„é‡å†™ï¼Œæ­£å¼ä» rewrite è¿ç§»åˆ° src
- âœ… æ—§ä»£ç å½’æ¡£è‡³ archive/src.old
- âœ… é‡‡ç”¨é…ç½®é©±åŠ¨çš„æ¨¡å—åŒ–æ¶æ„
- âœ… å®ç°ä¾èµ–æ³¨å…¥å®¹å™¨
- âœ… ç»Ÿä¸€ API åŒ…è£…å’Œé™é€Ÿ
- âœ… ä¸­é—´ä»¶æœºåˆ¶

## ğŸ“„ è®¸å¯è¯

è¯¦è§ LICENSE.md

## ğŸ”— ç›¸å…³é“¾æ¥

- [Discord.js æ–‡æ¡£](https://discord.js.org/)
- [æ¶æ„è®¾è®¡æ–‡æ¡£](src/plan.md)
- [é…ç½®è¯´æ˜](src/config/SETUP.md)
